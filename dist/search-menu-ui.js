var e=t(e);function t(e){return e||{}}var n=e.exports={};n.internalCreateIfNotExists=t;var i,r,l=!1;var o,s,u=u||(l||(l=!0,i={},((r=r||{}).exports={}).getEventTarget=function(e){if(void 0!==e.currentTarget&&null!=e.currentTarget)return e.currentTarget;if(void 0!==e.srcElement&&null!=e.srcElement)return e.srcElement;throw new Error("Event doesn't contain bounded element: "+e)}),i),a=!1;var c,d,f=f||(a||(a=!0,o={},((s=s||{}).exports={}).moveCursorToEndOf=function(e){if("function"==typeof e.setSelectionRange)e.setSelectionRange(e.value.length,e.value.length);else if("number"==typeof e.selectionStart&&"number"==typeof e.selectionEnd)e.selectionStart=e.selectionEnd=e.value.length;else if("function"==typeof e.createTextRange){var t=e.createTextRange();t.collapse(!0),t.moveEnd("character",e.value.length),t.moveStart("character",e.value.length),t.select()}}),o),m=!1;var h=h||(m||(m=!0,c={},((d=d||{}).exports={}).addEventListener=function(e,t,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent?t.attachEvent("on"+e,n):t["on"+e]=n}),c);n.SearchViewDescriptionBuilder=function(){function e(e,t){return function(e){return"string"==typeof e&&null!=e&&""!=e}(e)?e:t}return function(t){var n="{{displayName}}: {{value}}",i="{{summaries[0].displayName}}: {{summaries[0].value}}",r="{{view.listEntryElementIdPrefix}} {{category}}";this.description={viewElementId:t?t.viewElementId:"",listParentElementId:t?t.listParentElementId:"",listEntryElementIdPrefix:t?t.listEntryElementIdPrefix:"",listEntryElementTag:t?t.listEntryElementTag:"li",listEntryTextTemplate:t?t.listEntryTextTemplate:n,listEntrySummaryTemplate:t?t.listEntrySummaryTemplate:i,listEntryStyleClassTemplate:t?t.listEntryStyleClassTemplate:r,isSelectableFilterOption:!!t&&t.isSelectableFilterOption},this.viewElementId=function(t){return this.description.viewElementId=e(t,""),this},this.listParentElementId=function(t){return this.description.listParentElementId=e(t,""),this},this.listEntryElementIdPrefix=function(t){return this.description.listEntryElementIdPrefix=e(t,""),this},this.listEntryElementTag=function(t){return this.description.listEntryElementTag=e(t,"li"),this},this.listEntryTextTemplate=function(t){return this.description.listEntryTextTemplate=e(t,n),this},this.listEntrySummaryTemplate=function(t){return this.description.listEntrySummaryTemplate=e(t,i),this},this.listEntryStyleClassTemplate=function(t){return this.description.listEntryStyleClassTemplate=e(t,r),this},this.isSelectableFilterOption=function(e){return this.description.isSelectableFilterOption=!0===e,this},this.build=function(){return this.description}}}(),n.SearchMenuAPI=function(){function e(e,t,n){h.addEventListener(e,t,n)}function t(e){return u.getEventTarget(e)}function i(e,t){var n=new RegExp("\\s?\\b"+e+"\\b","gi");t.className=t.className.replace(n,"")}function r(e,t){return function(e){return"string"==typeof e&&null!=e&&""!=e}(e)?e:t}return function(){this.config={triggerSearch:function(){throw new Error("search service needs to be defined.")},convertData:function(e){return e},resolveTemplate:function(){throw new Error("template resolver needs to be defined.")},addPredefinedParametersTo:function(){},onCreatedElement:function(){},navigateTo:function(e){window.location.href=e},createdElementListeners:[],searchAreaElementId:"searcharea",inputElementId:"searchinputtext",searchTextParameterName:"searchtext",resultsView:(new n.SearchViewDescriptionBuilder).viewElementId("searchresults").listParentElementId("searchmatches").listEntryElementIdPrefix("result").listEntryTextTemplate("{{abbreviation}} {{displayName}}").listEntrySummaryTemplate("{{summaries[0].abbreviation}} <b>{{summaries[1].value}}</b><br>{{summaries[2].value}}: {{summaries[0].value}}").build(),detailView:(new n.SearchViewDescriptionBuilder).viewElementId("searchdetails").listParentElementId("searchdetailentries").listEntryElementIdPrefix("detail").listEntryTextTemplate("<b>{{displayName}}:</b> {{value}}").build(),filterOptionsView:(new n.SearchViewDescriptionBuilder).viewElementId("searchfilteroptions").listParentElementId("searchfilteroptionentries").listEntryElementIdPrefix("filter").listEntryTextTemplate("{{value}}").listEntrySummaryTemplate("{{summaries[0].value}}").isSelectableFilterOption(!0).build(),filtersView:(new n.SearchViewDescriptionBuilder).viewElementId("searchresults").listParentElementId("searchfilters").listEntryElementIdPrefix("filter").isSelectableFilterOption(!0).build(),waitBeforeClose:700,waitBeforeSearch:500,waitBeforeMouseOver:700},this.searchService=function(e){return this.config.triggerSearch=e,this},this.dataConverter=function(e){return this.config.convertData=e,this},this.templateResolver=function(e){return this.config.resolveTemplate=e,this},this.addPredefinedParametersTo=function(e){return this.config.addPredefinedParametersTo=e,this},this.setElementCreatedHandler=function(e){return this.config.onCreatedElement=e,this},this.addElementCreatedHandler=function(e){return this.config.createdElementListeners.push(e),this},this.addFocusStyleClassOnEveryCreatedElement=function(n){var l=r(n,"focus");return this.addElementCreatedHandler((function(n,r){r&&(e("focus",n,(function(e){!function(e,t){i(e,t);var n=t.className.length>0?" ":"";t.className+=n+e}(l,t(e))})),e("blur",n,(function(e){i(l,t(e))})))})),this},this.searchAreaElementId=function(e){return this.config.searchAreaElementId=r(e,"searcharea"),this},this.inputElementId=function(e){return this.config.inputElementId=r(e,"searchinputtext"),this},this.searchTextParameterName=function(e){return this.config.searchTextParameterName=r(e,"searchtext"),this},this.resultsView=function(e){return this.config.resultsView=e,this},this.detailView=function(e){return this.config.detailView=e,this},this.filterOptionsView=function(e){return this.config.filterOptionsView=e,this},this.filtersView=function(e){return this.config.filtersView=e,this},this.waitBeforeClose=function(e){return this.config.waitBeforeClose=e,this},this.waitBeforeSearch=function(e){return this.config.waitBeforeSearch=e,this},this.waitBeforeMouseOver=function(e){return this.config.waitBeforeMouseOver=e,this},this.start=function(){var e=this.config;return e.createdElementListeners.length>0&&this.setElementCreatedHandler((function(t,n){var i=0;for(i=0;i<e.createdElementListeners.length;i+=1)e.createdElementListeners[i](t,n)})),new n.SearchMenuUI(e)}}}(),n.SearchMenuUI=function(){function e(e,l,o){var s,u,d,f=o.resultsView.listEntryElementIdPrefix+"--"+l,m=D(e,o.resultsView,f,o.resolveTemplate),h=L(e,o.resultsView,f,m);if(q(H(e,o.resultsView,o.resolveTemplate),h),k(h,o.onCreatedElement),function(e){return void 0!==e.details}(e)&&(i(h,a(e.details,o,x)),s=h,u=o.waitBeforeMouseOver,d=a(e.details,o,x),te("mouseover",s,(function(e){this.originalEvent=function(e){for(var t={},n=Object.keys(e),i=0;i<n.length;i++){var r=n[i],l=e[r];t[r]=l}return t}(e),this.delayedHandlerTimer=window.setTimeout((function(){d(void 0!==this.originalEvent?this.originalEvent:e)}),u),this.preventEventHandling=function(){null!==this.delayedHandlerTimer&&clearTimeout(this.delayedHandlerTimer)},te("mouseout",s,this.preventEventHandling),te("mousedown",s,this.preventEventHandling),te("keydown",s,this.preventEventHandling)})),r(h,(function(){var t,n,i=(t=o.filtersView.listParentElementId,n=I(e,"category",""),T(t,(function(e){var t=c(e.id).hiddenFields(),i=I(t,"urltemplate",[""])[0];if(""===i)return null;var r=I(t,n,"");return r!=n&&""!==r||G("inactive",e)?null:i.value})));if(i){var r=o.resolveTemplate(i,e);o.navigateTo(r)}}))),function(e){return void 0!==e.options}(e)){var E=e.options;if(function(e){return void 0!==e.default}(e))E=function(e,t,n){if(!t)return e;var i,r=!1;for(i=0;i<e.length;i+=1)if(n(e[i],t)){r=!0;break}if(r)return e;var l=[];for(l.push(t),i=0;i<e.length;i+=1)l.push(e[i]);return l}(e.options,e.default[0],t(["value"])),function(e,t,n){X(e,a(t,n,S))}(g(e.default[0],E,o.filtersView,o),E,o);i(h,a(e.options,o,S)),r(h,a(e.options,o,S))}n(h,o)}function t(e){return function(t,n){var i;for(i=0;i<e.length;i+=1)if(t[e[i]]!=n[e[i]])return!1;return!0}}function n(e,t){$(e,s(t,E)),Z(e,s(t,v)),K(e,s(t,d)),ee(e,s(t,B))}function i(e,t){X(e,t),_(e,t)}function r(e,t){te("mousedown",e,t),Q(e,t)}function l(e,t){te("mousedown",e,t),Q(e,t),X(e,t)}function o(e,t){!function(e,t){te("keydown",e,(function(e){"Del"!=e.key&&"Delete"!=e.key&&46!=ie(e)||t(e)}))}(e,t),function(e,t){te("keydown",e,(function(e){"Backspace"!=e.key&&8!=ie(e)||t(e)}))}(e,t)}function s(e,t){return function(n){t(n,e)}}function a(e,t,n){return function(i){n(i,e,t)}}function c(e){var t="--",n=e.split(t);n.length<2&&console.log("expected at least one '--' separator inside the id "+e);var i=n[0],r=parseInt(n[1]),l=n[n.length-2],o=parseInt(n[n.length-1]),s=e.substring(0,e.lastIndexOf(o)-t.length);return{id:e,type:l,index:o,previousId:s+t+(o-1),nextId:s+t+(o+1),firstId:s+t+"1",lastId:s+t+document.getElementById(e).parentElement.childNodes.length,mainMenuId:i+t+r,mainMenuIndex:r,hiddenFieldsId:e+t+"fields",isFirstElement:o<=1,isSubMenu:n.length>3,subMenuId:function(n){return e+t+n+t+"1"},replaceMainMenuIndex:function(n){return i+t+n+e.substring(this.mainMenuId.length)},getNewIndexAfterRemovedMainMenuIndex:function(t){if(r<t)return e;if(r==t)throw new Error("index "+t+" should had been removed.");return this.replaceMainMenuIndex(r-1)},hiddenFields:function(){var n=document.getElementById(e+t+"fields"),i=I(n,"textContent",n.innerText);return JSON.parse(i)}}}function d(e,t){var n=ne(e),i=document.getElementById(t.inputElementId);return n.blur(),i.focus(),f.moveCursorToEndOf(i),V(e),A(t),i}function m(e,t){var n=ne(e),i=document.getElementById(t.resultsView.listEntryElementIdPrefix+"--1");i&&(n.blur(),i.focus())}function E(e,t){p(e,(function(e){var n=null;return e.type===t.resultsView.listEntryElementIdPrefix&&(n=document.getElementById(t.filterOptionsView.listEntryElementIdPrefix+"--1")),null===n&&(n=document.getElementById(t.resultsView.listEntryElementIdPrefix+"--1")),n})),A(t)}function v(e,t){y(e,(function(n){var i=null;if(n.type===t.filterOptionsView.listEntryElementIdPrefix){var r=F(t.resultsView.listEntryElementIdPrefix);i=document.getElementById(t.resultsView.listEntryElementIdPrefix+"--"+r)}return null===i?d(e,t):i})),A(t)}function p(e,t){var n=ne(e),i=c(n.id);i.isSubMenu&&V(e);var r=document.getElementById(i.nextId);null==r&&"function"==typeof t&&(r=t(i)),null==r&&(r=document.getElementById(i.firstId)),null!=r&&(n.blur(),r.focus())}function y(e,t){var n=ne(e),i=c(n.id);i.isSubMenu&&V(e);var r=document.getElementById(i.previousId);null==r&&"function"==typeof t&&(r=t(i)),null==r&&(r=document.getElementById(i.lastId)),null!=r&&(n.blur(),r.focus())}function w(e,n,i){!function(e,t,n){X(e,N),o(e,s(n,C))}(g(function(e,t,n){var i,r,l=c(e).hiddenFields();for(i=0;i<t.length;i+=1)if(n(r=t[i],l))return r;return console.log("error: no selected entry found for id "+e+" in "+t),null}(ne(e).id,n,t(["fieldName","value"])),n,i.filtersView,i),0,i),V(e),P(e)}function g(e,t,i,r){var l,o,s,u,d,f,m,h,E,v=F(i.listEntryElementIdPrefix),p=i.listEntryElementIdPrefix+"--"+(v+1),y=I(e,"category",""),w=(l=y,o=e.fieldName,s=i.listParentElementId,u=null,null!=(d=T(s,(function(e){var t=c(e.id).hiddenFields();if(t.fieldName===o){var n=I(t,"category","");if(""===n)u=e;else if(n===l)return e}})))?d:u);if(null!=w){var g=D(e,i,w.id,r.resolveTemplate);return m=g,(f=w).innerHTML=m,w=f}return w=L(e,i,p,D(e,i,p,r.resolveTemplate)),q(H(e,i,r.resolveTemplate),w),k(w,r.onCreatedElement),h=w,E=a(t,r,S),te("mousedown",h,E),Q(h,E),_(h,E),n(w,r),w}function I(e,t,n){return void 0===e[t]?n:e[t]}function T(e,t){var n,i,r=document.getElementById(e);for(n=0;n<r.childNodes.length;n+=1)if(i=t(r.childNodes[n]))return i;return null}function x(e,t,n){A(n),b(e,t,n.detailView,n),V(e)}function S(e,t,n){A(n),b(e,t,n.filterOptionsView,n)}function b(e,t,n,i){!function(e){var t=document.getElementById(e);if("function"==typeof t.cloneNode&&"function"==typeof t.replaceChild){var n=t.cloneNode(!1);t.parentNode.replaceChild(n,t)}else t.innerHTML=""}(n.listParentElementId);var r,o=ne(e),s=null,u=null,c=0,d=o.id+"--"+n.listEntryElementIdPrefix,f=null;for(c=0;c<t.length;c+=1)u=L(s=t[c],n,d=o.id+"--"+n.listEntryElementIdPrefix+"--"+(c+1),D(s,n,d,i.resolveTemplate)),q(H(s,n,i.resolveTemplate),u),k(u,i.onCreatedElement),n.isSelectableFilterOption&&($(r=u,p),Z(r,y),ee(r,P),K(r,P),l(u,a(t,i,w))),0===c&&(f=u);var m=j(o,(function(e){return"DIV"==e.tagName})),h=document.getElementById(n.viewElementId),E=m.offsetWidth+15,v=function(e){var t=e.getBoundingClientRect();if(void 0!==t.y)return t.y;return t.top}(o)+function(){if(void 0!==window.pageYOffset)return window.pageYOffset;if("CSS1Compat"===(document.compatMode||""))return document.documentElement.scrollTop;return document.body.scrollTop}();h.style.left=E+"px",h.style.top=v+"px",J(h),n.isSelectableFilterOption&&(o.blur(),f.focus())}function P(e){var t=ne(e),n=c(t.id),i=document.getElementById(n.mainMenuId);t.blur(),i.focus(),function(e){var t=j(e,(function(e){return G("show",e)}));if(null!=t)W(t)}(t)}function B(e,t){A(t)}function V(e){void 0!==e.preventDefault?e.preventDefault():e.returnValue=!1}function N(e){V(e);var t,n,i=ne(e);G(t="inactive",n=i)?z(t,n):q(t,n)}function C(e,t){V(e),v(e,t),function(e){var t=ne(e),n=t.parentElement,i=c(t.id).mainMenuIndex;n.removeChild(t),O(n,0,5,(function(e){e.id&&(e.id=c(e.id).getNewIndexAfterRemovedMainMenuIndex(i))}))}(e)}function O(e,t,n,i){t>n||!e.childNodes||M(e.childNodes,(function(e){i(e),O(e,t+1,n,i)}))}function k(e,t){e.id&&t(e,!0),M(e.childNodes,(function(e){e.id&&t(e,!1)}))}function M(e,t){var n=0;for(n=0;n<e.length;n+=1)t(e[n],n+1)}function F(e){var t=document.getElementById(e+"--1");return null===t?0:t.parentElement.childNodes.length}function L(e,t,n,i){var r=function(e,t,n){var i=document.createElement(n);return i.id=t,i.tabIndex="0",i.innerHTML=e,i}(i,n,t.listEntryElementTag);return document.getElementById(t.listParentElementId).appendChild(r),r}function D(e,t,n,i){var r=i(t.listEntryTextTemplate,e);return void 0!==e.summaries&&(r=i(t.listEntrySummaryTemplate,e)),r+='<p id="'+n+'--fields" style="display: none">'+JSON.stringify(e)+"</p>"}function H(e,t,n){var i=n(t.listEntryStyleClassTemplate,e);return i=n(i,{view:t})}function R(e){Y(e.resultsView.viewElementId),Y(e.detailView.viewElementId),Y(e.filterOptionsView.viewElementId)}function A(e){Y(e.detailView.viewElementId),Y(e.filterOptionsView.viewElementId)}function U(e){J(document.getElementById(e))}function J(e){q("show",e)}function Y(e){W(document.getElementById(e))}function j(e,t){for(var n=e;null!=n;){if(t(n))return n;n=n.parentNode}return null}function W(e){z("show",e)}function q(e,t){z(e,t);var n=t.className.length>0?" ":"";t.className+=n+e}function z(e,t){var n=new RegExp("\\s?\\b"+e+"\\b","gi");t.className=t.className.replace(n,"")}function G(e,t){return null!=t.className&&t.className.indexOf(e)>=0}function K(e,t){te("keydown",e,(function(e){"Escape"!=e.key&&"Esc"!=e.key&&27!=ie(e)||t(e)}))}function Q(e,t){te("keydown",e,(function(e){"Enter"!=e.key&&13!=ie(e)||t(e)}))}function X(e,t){te("keydown",e,(function(e){" "!=e.key&&"Spacebar"!=e.key&&32!=ie(e)||t(e)}))}function Z(e,t){te("keydown",e,(function(e){"ArrowUp"!=e.key&&"Up"!=e.key&&38!=ie(e)||t(e)}))}function $(e,t){te("keydown",e,(function(e){"ArrowDown"!=e.key&&"Down"!=e.key&&40!=ie(e)||t(e)}))}function _(e,t){te("keydown",e,(function(e){"ArrowRight"!=e.key&&"Right"!=e.key&&39!=ie(e)||t(e)}))}function ee(e,t){te("keydown",e,(function(e){"ArrowLeft"!=e.key&&"Left"!=e.key&&37!=ie(e)||t(e)}))}function te(e,t,n){h.addEventListener(e,t,n)}function ne(e){return u.getEventTarget(e)}function ie(e){return void 0===e.keyCode?-1:e.keyCode}return function(t){this.config=t,this.currentSearchText="",this.focusOutTimer=null,this.waitBeforeSearchTimer=null;var n=document.getElementById(t.inputElementId);K(n,(function(e){ne(e).value="",R(t)})),$(n,s(t,m)),te("keyup",n,(function(n){null!==this.waitBeforeSearchTimer&&clearTimeout(this.waitBeforeSearchTimer);var i=ne(n).value;this.waitBeforeSearchTimer=window.setTimeout((function(){i===this.currentSearchText&&""!==this.currentSearchText||(!function(t,n){if(document.getElementById(n.resultsView.listParentElementId).innerHTML="",0===t.length)return void R(n);U(n.resultsView.viewElementId),function(t,n){var i=(r=n.filtersView.listParentElementId,l={},T(r,(function(e){var t=c(e.id).hiddenFields();return void 0===t.fieldName||void 0===t.value||G("inactive",e)?null:void(l[t.fieldName]=t.value)})),l);var r,l;i[n.searchTextParameterName]=t,n.addPredefinedParametersTo(i),n.triggerSearch(i,(function(t){!function(t,n){var i=0;for(i=0;i<t.length;i+=1)e(t[i],i+1,n)}(n.convertData(t),n)}))}(t,n)}(i,t),this.currentSearchText=i)}),t.waitBeforeSearch)}));var i=document.getElementById(t.searchAreaElementId);te("focusin",i,(function(){""!==document.getElementById(t.inputElementId).value&&(null!=this.focusOutTimer&&clearTimeout(this.focusOutTimer),U(t.resultsView.viewElementId))})),te("focusout",i,(function(){this.focusOutTimer=window.setTimeout((function(){R(t)}),t.waitBeforeClose)}))}}();
//# sourceMappingURL=search-menu-ui.js.map
